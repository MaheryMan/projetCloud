import{d as L,r as d,c as k,a as N,u as P,s as R,w as U,o as p,b as E,e as r,f as n,g as e,I as j,h as m,i as h,l as I,j as H,k as D,m as G,n as F,p as V,q as y,t as M,v as q,x as $,y as J,z as w,A as K,B as Q,C as A,D as O,E as X,F as Y}from"./index-DV0vJRQT.js";import{o as Z,h as ee,l as oe,a as le,b as ne,u as S,_ as ae}from"./_plugin-vue_export-helper-BLJwWxij.js";const te=L("auth",()=>{const t=d(null),i=d(!1),u=d(!1),s=d(!1),l=d(null);i.value||Z(o=>{t.value=o,i.value=!0}),u.value||(u.value=!0,ee().then(o=>{o&&(t.value=o)}).catch(o=>{l.value=(o==null?void 0:o.message)||"Erreur de connexion Google"}));const c=k(()=>!!t.value);return{user:t,initialized:i,redirectHandled:u,loading:s,error:l,isAuthenticated:c,loginWithEmail:async(o,b)=>{s.value=!0,l.value=null;try{const g=await oe(o,b);t.value=g}catch(g){throw l.value=(g==null?void 0:g.message)||"Erreur de connexion",g}finally{s.value=!1}},loginGoogleAction:async()=>{s.value=!0,l.value=null;try{const o=await le();t.value=o}catch(o){throw l.value=(o==null?void 0:o.message)||"Erreur de connexion Google",o}finally{s.value=!1}},logoutAction:async()=>{await ne(),t.value=null}}});function se(){const t=d(null),{showToast:i}=S();return{lastError:t,handleError:(l,c="Une erreur est survenue")=>{const v=(l==null?void 0:l.message)||c;console.error(l),t.value=v,i(v,"danger")},clearError:()=>{t.value=null}}}function ie(t){const i=k(()=>{const s={};return Object.entries(t).forEach(([l,c])=>{(!c.value||!c.value.toString().trim())&&(s[l]="Ce champ est obligatoire")}),s}),u=k(()=>Object.keys(i.value).length>0);return{errors:i,hasErrors:u}}const re={class:"login-container"},ue={class:"brand-section"},ce={class:"logo-circle"},de={class:"form-section"},ge={key:1},me={class:"forgot-password"},ve={key:1},fe=N({__name:"LoginPage",setup(t){const i=d(""),u=d(""),s=d(!1),l=d(!1),c=P(),v=te(),{loading:x,error:C}=R(v),{showToast:o}=S(),{handleError:b,clearError:g}=se(),{hasErrors:B}=ie({email:i,password:u});U(()=>v.isAuthenticated,f=>{f&&c.replace("/home")},{immediate:!0});const T=async()=>{if(g(),B.value){o("Veuillez remplir tous les champs obligatoires","warning");return}try{await v.loginWithEmail(i.value,u.value),o("Connexion réussie","success"),c.replace("/home")}catch(f){b(f,"Email ou mot de passe incorrect")}},z=async()=>{g(),s.value=!0;try{await v.loginGoogleAction(),o("Connexion Google en cours...","primary")}catch(f){b(f,"Erreur lors de la connexion avec Google")}finally{s.value=!1}},W=()=>{c.push("/home")};return(f,a)=>(p(),E(e(Y),null,{default:r(()=>[n(e(j),{class:"login-content",fullscreen:!0},{default:r(()=>[m("div",re,[m("div",ue,[m("div",ce,[n(e(h),{icon:e(I),class:"logo-icon"},null,8,["icon"])]),a[3]||(a[3]=m("h1",{class:"brand-title"},"Bienvenue",-1)),a[4]||(a[4]=m("p",{class:"brand-subtitle"},"Connectez-vous à votre compte",-1))]),m("div",de,[n(e(H),{class:"login-card"},{default:r(()=>[n(e(D),null,{default:r(()=>[n(e(G),{lines:"none",class:"input-item"},{default:r(()=>[n(e(h),{icon:e(F),slot:"start",class:"input-icon"},null,8,["icon"]),n(e(V),{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=_=>i.value=_),label:"Email","label-placement":"floating",type:"email",placeholder:"email@exemple.com"},null,8,["modelValue"])]),_:1}),n(e(G),{lines:"none",class:"input-item"},{default:r(()=>[n(e(h),{icon:e(I),slot:"start",class:"input-icon"},null,8,["icon"]),n(e(V),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=_=>u.value=_),label:"Mot de passe","label-placement":"floating",type:l.value?"text":"password"},null,8,["modelValue","type"]),n(e(y),{fill:"clear",slot:"end",onClick:a[2]||(a[2]=_=>l.value=!l.value),class:"password-toggle"},{default:r(()=>[n(e(h),{icon:l.value?e(M):e(q),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1}),e(C)?(p(),E(e($),{key:0,color:"danger",class:"error-text"},{default:r(()=>[n(e(h),{icon:e(J)},null,8,["icon"]),w(" "+K(e(C)),1)]),_:1})):Q("",!0),n(e(y),{expand:"block",onClick:T,disabled:e(x),class:"login-button"},{default:r(()=>[e(x)?(p(),E(e(A),{key:0,name:"crescent"})):(p(),O("span",ge,"Se connecter"))]),_:1},8,["disabled"]),m("div",me,[n(e(y),{fill:"clear",size:"small"},{default:r(()=>[...a[5]||(a[5]=[w(" Mot de passe oublié ? ",-1)])]),_:1})]),a[7]||(a[7]=m("div",{class:"divider"},[m("span",{class:"divider-text"},"OU")],-1)),n(e(y),{expand:"block",onClick:z,disabled:s.value,class:"google-button"},{default:r(()=>[n(e(h),{icon:e(X),slot:"start"},null,8,["icon"]),s.value?(p(),E(e(A),{key:0,name:"crescent"})):(p(),O("span",ve,"Se connecter avec Google"))]),_:1},8,["disabled"]),n(e(y),{expand:"block",fill:"outline",onClick:W,class:"guest-button"},{default:r(()=>[...a[6]||(a[6]=[w(" Continuer sans se connecter ",-1)])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}))}}),ye=ae(fe,[["__scopeId","data-v-f283ebf8"]]);export{ye as default};
